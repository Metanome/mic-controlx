<UserControl x:Class="MicControlX.UpdatePanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:local="clr-namespace:MicControlX"
             Height="Auto" 
             Visibility="Collapsed"
             MouseDown="UpdatePanel_MouseDown">
    
    <UserControl.Resources>
        <!-- Simple Fade In Animation -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.3"/>
        </Storyboard>
        
        <!-- Simple Fade Out Animation -->
        <Storyboard x:Key="FadeOutAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1" To="0" Duration="0:0:0.2"/>
        </Storyboard>
        
        <!-- Progress Bar Style -->
        <Style x:Key="UpdateProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Height" Value="12"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}"/>
            <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource AccentFillColorDefaultBrush}"/>
        </Style>
    </UserControl.Resources>

    <!-- Main Panel -->
    <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
            BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
            BorderThickness="0"
            CornerRadius="0">
        
        <Grid Margin="20,8,20,8">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Header Section -->
            <Grid Grid.Row="0" Margin="0,0,0,2">
                <!-- Update Status Text -->
                <TextBlock x:Name="StatusText" 
                          Text="Checking for updates..."
                          FontWeight="SemiBold"
                          FontSize="14"
                          Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                          VerticalAlignment="Center"/>
            </Grid>
            
            <!-- Progress Section -->
            <Grid Grid.Row="1" x:Name="ProgressSection" Visibility="Visible">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Progress Bar -->
                <ProgressBar x:Name="ProgressBar"
                           Grid.Row="0"
                           Style="{StaticResource UpdateProgressBarStyle}"
                           Value="0" Maximum="100"
                           Margin="0,0,0,6"/>
                
                <!-- Progress Text -->
                <TextBlock x:Name="ProgressText"
                          Grid.Row="1"
                          Text="Preparing download..."
                          FontSize="12"
                          FontWeight="Medium"
                          Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                          HorizontalAlignment="Center"/>
            </Grid>
            
            <!-- Action Buttons -->
            <StackPanel Grid.Row="2" 
                       Orientation="Horizontal" 
                       HorizontalAlignment="Right"
                       Margin="0,6,0,0">
                
                <!-- Download Button -->
                <ui:Button x:Name="DownloadButton"
                          Content="{Binding Download, Source={x:Static local:LocalizationManager.Instance}}"
                          Appearance="Primary"
                          Padding="12,8"
                          Margin="4,0"
                          HorizontalContentAlignment="Center"
                          Click="DownloadButton_Click"
                          Visibility="Visible"/>
                
                <!-- Cancel Button -->
                <ui:Button x:Name="CancelButton"
                          Content="{Binding Cancel, Source={x:Static local:LocalizationManager.Instance}}"
                          Appearance="Secondary"
                          Padding="12,8"
                          Margin="4,0"
                          HorizontalContentAlignment="Center"
                          Click="CancelButton_Click"
                          Visibility="Visible"/>
                
                <!-- Restart Button -->
                <ui:Button x:Name="RestartButton"
                          Content="{Binding RestartAndUpdate, Source={x:Static local:LocalizationManager.Instance}}"
                          Appearance="Primary"
                          Padding="12,8"
                          Margin="4,0"
                          HorizontalContentAlignment="Center"
                          Click="RestartButton_Click"
                          Visibility="Collapsed"/>
                
                <!-- Try Again Button -->
                <ui:Button x:Name="TryAgainButton"
                          Content="{Binding TryAgain, Source={x:Static local:LocalizationManager.Instance}}"
                          Appearance="Secondary"
                          Padding="12,8"
                          Margin="4,0"
                          HorizontalContentAlignment="Center"
                          Click="TryAgainButton_Click"
                          Visibility="Collapsed"/>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>